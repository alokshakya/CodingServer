<!DOCTYPE html>
<html>

<head>
<title>Submit Question</title>
<script type="text/javascript"></script>
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  ></script>
</head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<script type="text/javascript">	

$(document).ready(function(){

	   // jQuery methods go here...
	document.getElementById("btn").innerHTML='Submit';
	$("#feedback_form").submit(function(event){
		//alert('clicked');
	    event.preventDefault(); //prevent default action 
	    document.getElementById("btn").innerHTML='Submitting....';
  //ajax method starts here
  var sqldata=JSON.stringify(
    {
    "type": "insert",
    "args": {
        "table": "Questions",
        "objects": [
                          {
                              "Question": document.getElementById("question").value,
                              "a": document.getElementById("a_option").value,
                              "b": document.getElementById("b_option").value,
                              "c": document.getElementById("c_option").value,
                              "d": document.getElementById("d_option").value,
                              "ans": document.getElementById("ans").value
                          }
                    ]
            }
    }
  );
	 
	    $.ajax({
			  type: 'POST',
			  url: "https://data.enlightenment56.hasura-app.io/v1/query",
			  data:sqldata,
			  error: function(e) { 
				  console.log(e);
				  document.getElementById("btn").innerHTML='Submition Failed Try Again';
				  
				
			  },
			  success:function(data){
                  //todo on success
                  //show these immidiately
                  document.getElementById("btn").innerHTML='Submitted';
                      $("#feedback ul").append('<li> Affected Rows :'+data.affected_rows+'</li>');
                      
                  setTimeout(function(){ 
                      // this function is used to change status of Submitted to Submit after 2 sec
                    document.getElementById("btn").innerHTML='Submit';
                    //reset fields of form
                    document.getElementById("question").innerHTML='';
                    document.getElementById("a_option").innerHTML='';
                    document.getElementById("b_option").innerHTML='';
                    document.getElementById("c_option").innerHTML='';
                    document.getElementById("d_option").innerHTML='';
                    document.getElementById("answer").innerHTML='';
                    }, 2000);
                    	
			  	
			  	
			  },
			  dataType: "json",
			  contentType: "application/json"
			});
	    //ajax method ended
  });
  
	});
</script>
<body>
  <div id="feedback">
    <ul>
    </ul>
    </div>
  <!-- Contact Section -->
  
    <p>Submit Questions</p>
    <form  id="feedback_form">
      <textarea rows= "4" cols="100" placeholder="Question" id="question"></textarea><br>
      <textarea rows= "4" cols="100" placeholder="A Option" id="a_option"></textarea><br>
      <textarea rows= "4" cols="100"  placeholder="B Option"  id="b_option"></textarea><br>
      <textarea rows= "4" cols="100"   placeholder="C Option"  id="c_option"></textarea><br>
      <textarea rows= "4" cols="100" placeholder="D Option"  id="d_option"></textarea><br>
      <textarea rows= "4" cols="100"  placeholder="Answer"  id="ans"></textarea><br>
    
      
      <button  type="submit" id="btn">
        
      </button>
      
    </form>
  </div>

</body>
</html>
